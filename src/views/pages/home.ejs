<!DOCTYPE html>
<html lang="en">
  <head>
    <title>mycontest - Home</title>
    <%- include("../basic/head.ejs") %>
    <style>
      .hero {
        background: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        box-shadow: none;
      }
      .stat-card {
        border-radius: 12px;
        border: 1px solid #e5e7eb;
        background: #fff;
        box-shadow: none;
      }
    </style>
  </head>

  <body>
    <%- include("../basic/navbar.ejs", { data: { user_id: user ? user.user_id : null, full_name: user ? (user.full_name || user.username) : null } }) %>

    <main class="container py-4" style="min-height: 70vh;">
      <section class="hero p-4 p-md-5 mb-4">
        <div class="row align-items-center gy-3">
          <div class="col-lg-7">
            <p class="text-primary mb-2 fw-semibold text-uppercase small">Welcome</p>
            <h1 class="display-6 fw-bold mb-3">Practice, compete, and grow on mycontest</h1>
            <p class="text-secondary mb-4">Solve problems, join contests, and sharpen your coding skills with a clean, distraction-free interface.</p>
            <div class="d-flex gap-2">
              <a href="/problems" class="btn btn-primary px-4">Browse Problems</a>
              <a href="/contests" class="btn btn-outline-secondary px-4">View Contests</a>
            </div>
          </div>
          <div class="col-lg-5">
            <div class="stat-card p-3">
              <div class="d-flex justify-content-between mb-3">
                <div>
                  <div class="text-muted small">Problems</div>
                  <div class="fs-2 fw-semibold"><%= (stats && stats.total_problems) || 0 %></div>
                </div>
                <div>
                  <div class="text-muted small">Languages</div>
                  <div class="fs-2 fw-semibold text-success"><%= (stats && stats.total_languages) || 0 %></div>
                </div>
                <div>
                  <div class="text-muted small">Submissions</div>
                  <div class="fs-2 fw-semibold text-primary"><%= (stats && stats.total_submissions) || 0 %></div>
                </div>
              </div>
              <div class="progress" style="height: 8px;">
                <div class="progress-bar bg-primary" style="width: 40%;"></div>
                <div class="progress-bar bg-success" style="width: 30%;"></div>
                <div class="progress-bar bg-warning" style="width: 30%;"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <% if (problems && problems.length) { %>
      <section class="mb-4">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 class="fw-bold mb-0">Recent Problems</h5>
          <a href="/problems" class="text-decoration-none">View all</a>
        </div>
        <div class="row g-3">
          <% problems.slice(0, 6).forEach((problem) => { %>
            <div class="col-md-4">
              <div class="stat-card p-3 h-100">
                <div class="d-flex justify-content-between align-items-start mb-2">
                  <a href="/problems/<%= problem.problem_id %>" class="fw-semibold text-dark"><%= problem.title %></a>
                  <span class="badge bg-light text-dark border"><%= problem.difficulty %></span>
                </div>
                <div class="text-muted small mb-3"><%= (problem.description || "").slice(0, 120) %>...</div>
                <div class="d-flex align-items-center gap-3 text-muted small">
                  <span><i class="fa fa-code"></i> <%= problem.language_count || 0 %> langs</span>
                  <span><i class="fa fa-check-circle-o text-success"></i> <%= problem.solved_count || 0 %> solved</span>
                </div>
              </div>
            </div>
          <% }) %>
        </div>
      </section>
      <% } %>
    </main>

    <%- include("../basic/footer.ejs") %>
  </body>
</html>
